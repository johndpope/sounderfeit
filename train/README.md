
# Dataset generation and training

This folder contains files used to generate the two datasets used in
the Sounderfeit paper, as well as the Tensorflow code to define and
train the network.

WARNING: It still needs quite some work to be usable, but I include it
here for completeness.  I will try to make it more usable and readable
shortly.

## Dataset generation

Here is a quick rundown of the files:

    generate_bowed_samples.cpp
    Makefile

Use `make` to compile `generate_bowed_samples`, you will probably need
to modify the paths in the Makefile to where your STK build is
installed.  Currently there are not command-line parameters, just
modify `main()` and recompile to utilise the different functions.
Each function generates CSV numerical data on stdout and should be
directed to "bowed.csv" for example. The main functions of interest
are:

    iterateParameters();

For each combination of the pressure and position parameters, values 0
through 128, runs the STK Bowed object until steady state (1 second)
and saves the last cycle.  For "bowed.csv".

    sweepPressureAndPosition();

Sweep through a couple of trajectories of pressure and position and
save it.  For "known.csv".

    randomWalkParameters(1000000);

Randomly modifies pressure and position at random intervals and
outputs some cycles as it goes.  For "bowed3.csv".

    generate_bowed_h5.py
    generate_bowed3_h5.py
    generate_known_h5.py

These Python scripts take the CSV files produced by the C++ functions
and write the data to HDF5 format after some processing to identify
and align the phase of all cycles (YMMV).  

## Training

    bowed.py
    bowed3.py
    vowels.py

These are Python modules that load the HDF5 files generated above and
provide them to the training script in a (mostly) uniform manner.

    overlap_add.py

Defines a function that takes a series of parameters and calls a
function to generate windows of audio and performs overlap-add to
merge them into a stream, used for one diagram in the paper, and to
generate wav format output.

    sounderfeit_train.py

This script loads a dataset generated by the above steps and trains a
neural network implementing an adversarial conditional autoencoder, as
described in the paper.

The top part generates the neural network, the middle part trains it,
the bottom part does a bunch of plotting and is quite complicated in
order to handle all the variations of parameter configurations I
explored during this work.

Finally it writes the results to a pickle file containing the network
weights.  Some pre-generated ones are found in this repository's
"weights" directory.

WARNING: It is very disorganized and hard to read.  I will work on
organizing this better shortly.
